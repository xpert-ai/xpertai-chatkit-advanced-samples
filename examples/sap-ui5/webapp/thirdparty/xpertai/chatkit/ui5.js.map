{"version":3,"file":"chatkit.ui5.js","sources":["../../web-component/dist/xpert-chatkit.js","../src/chatkit.ts"],"sourcesContent":["var __create = Object.create;\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __knownSymbol = (name, symbol) => (symbol = Symbol[name]) ? symbol : Symbol.for(\"Symbol.\" + name);\nvar __typeError = (msg) => {\n  throw TypeError(msg);\n};\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __name = (target, value) => __defProp(target, \"name\", { value, configurable: true });\nvar __decoratorStart = (base) => [, , , __create((base == null ? void 0 : base[__knownSymbol(\"metadata\")]) ?? null)];\nvar __decoratorStrings = [\"class\", \"method\", \"getter\", \"setter\", \"accessor\", \"field\", \"value\", \"get\", \"set\"];\nvar __expectFn = (fn) => fn !== void 0 && typeof fn !== \"function\" ? __typeError(\"Function expected\") : fn;\nvar __decoratorContext = (kind, name, done, metadata, fns) => ({ kind: __decoratorStrings[kind], name, metadata, addInitializer: (fn) => done._ ? __typeError(\"Already initialized\") : fns.push(__expectFn(fn || null)) });\nvar __decoratorMetadata = (array, target) => __defNormalProp(target, __knownSymbol(\"metadata\"), array[3]);\nvar __runInitializers = (array, flags, self, value) => {\n  for (var i = 0, fns = array[flags >> 1], n = fns && fns.length; i < n; i++) flags & 1 ? fns[i].call(self) : value = fns[i].call(self, value);\n  return value;\n};\nvar __decorateElement = (array, flags, name, decorators, target, extra) => {\n  var fn, it, done, ctx, access, k = flags & 7, s = !!(flags & 8), p = !!(flags & 16);\n  var j = k > 3 ? array.length + 1 : k ? s ? 1 : 2 : 0, key = __decoratorStrings[k + 5];\n  var initializers = k > 3 && (array[j - 1] = []), extraInitializers = array[j] || (array[j] = []);\n  var desc = k && (!p && !s && (target = target.prototype), k < 5 && (k > 3 || !p) && __getOwnPropDesc(k < 4 ? target : { get [name]() {\n    return __privateGet(this, extra);\n  }, set [name](x) {\n    return __privateSet(this, extra, x);\n  } }, name));\n  k ? p && k < 4 && __name(extra, (k > 2 ? \"set \" : k > 1 ? \"get \" : \"\") + name) : __name(target, name);\n  for (var i = decorators.length - 1; i >= 0; i--) {\n    ctx = __decoratorContext(k, name, done = {}, array[3], extraInitializers);\n    if (k) {\n      ctx.static = s, ctx.private = p, access = ctx.access = { has: p ? (x) => __privateIn(target, x) : (x) => name in x };\n      if (k ^ 3) access.get = p ? (x) => (k ^ 1 ? __privateGet : __privateMethod)(x, target, k ^ 4 ? extra : desc.get) : (x) => x[name];\n      if (k > 2) access.set = p ? (x, y) => __privateSet(x, target, y, k ^ 4 ? extra : desc.set) : (x, y) => x[name] = y;\n    }\n    it = (0, decorators[i])(k ? k < 4 ? p ? extra : desc[key] : k > 4 ? void 0 : { get: desc.get, set: desc.set } : target, ctx), done._ = 1;\n    if (k ^ 4 || it === void 0) __expectFn(it) && (k > 4 ? initializers.unshift(it) : k ? p ? extra = it : desc[key] = it : target = it);\n    else if (typeof it !== \"object\" || it === null) __typeError(\"Object expected\");\n    else __expectFn(fn = it.get) && (desc.get = fn), __expectFn(fn = it.set) && (desc.set = fn), __expectFn(fn = it.init) && initializers.unshift(fn);\n  }\n  return k || __decoratorMetadata(array, target), desc && __defProp(target, name, desc), p ? k ^ 4 ? extra : desc : target;\n};\nvar __accessCheck = (obj, member, msg) => member.has(obj) || __typeError(\"Cannot \" + msg);\nvar __privateIn = (member, obj) => Object(obj) !== obj ? __typeError('Cannot use the \"in\" operator on this value') : member.has(obj);\nvar __privateGet = (obj, member, getter) => (__accessCheck(obj, member, \"read from private field\"), getter ? getter.call(obj) : member.get(obj));\nvar __privateAdd = (obj, member, value) => member.has(obj) ? __typeError(\"Cannot add the same private member more than once\") : member instanceof WeakSet ? member.add(obj) : member.set(obj, value);\nvar __privateSet = (obj, member, value, setter) => (__accessCheck(obj, member, \"write to private field\"), setter ? setter.call(obj, value) : member.set(obj, value), value);\nvar __privateMethod = (obj, member, method) => (__accessCheck(obj, member, \"access private method\"), method);\nvar _setTrainingOptOut_dec, _hideHistory_dec, _showHistory_dec, _sendCustomAction_dec, _shareThread_dec, _setThreadId_dec, _setComposerValue_dec, _sendUserMessage_dec, _fetchUpdates_dec, _focusComposer_dec, _a2, _opts, _frameUrl, _frame, _wrapper, _shadow, _resolveLoaded, _loaded, _messenger, _ChatKitElementBase_instances, emitAndThrow_fn, setOptionsDataAttributes_fn, getFrameUrl_fn, setFrameUrl_fn, consumeFrameUrl_fn, _handleFrameLoad, _initialized, maybeInit_fn, _init;\nvar __defProp2 = Object.defineProperty;\nvar __defNormalProp2 = (obj, key, value) => key in obj ? __defProp2(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField = (obj, key, value) => __defNormalProp2(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\nvar _a, _b;\nclass EventEmitter {\n  constructor() {\n    __publicField(this, \"callbacks\", /* @__PURE__ */ new Map());\n  }\n  on(event, callback) {\n    if (!this.callbacks.has(event)) {\n      this.callbacks.set(event, /* @__PURE__ */ new Set());\n    }\n    this.callbacks.get(event).add(callback);\n  }\n  emit(event, ...args) {\n    var _a22;\n    const data = args[0];\n    (_a22 = this.callbacks.get(event)) == null ? void 0 : _a22.forEach((callback) => callback(data));\n  }\n  off(event, callback) {\n    var _a22;\n    if (!callback) {\n      this.callbacks.delete(event);\n    } else {\n      (_a22 = this.callbacks.get(event)) == null ? void 0 : _a22.delete(callback);\n    }\n  }\n  allOff() {\n    this.callbacks.clear();\n  }\n}\nasync function getBytes(stream, onChunk) {\n  const reader = stream.getReader();\n  let result;\n  while (!(result = await reader.read()).done) {\n    onChunk(result.value);\n  }\n}\nfunction getLines(onLine) {\n  let buffer;\n  let position;\n  let fieldLength;\n  let discardTrailingNewline = false;\n  return function onChunk(arr) {\n    if (buffer === void 0) {\n      buffer = arr;\n      position = 0;\n      fieldLength = -1;\n    } else {\n      buffer = concat(buffer, arr);\n    }\n    const bufLength = buffer.length;\n    let lineStart = 0;\n    while (position < bufLength) {\n      if (discardTrailingNewline) {\n        if (buffer[position] === 10) {\n          lineStart = ++position;\n        }\n        discardTrailingNewline = false;\n      }\n      let lineEnd = -1;\n      for (; position < bufLength && lineEnd === -1; ++position) {\n        switch (buffer[position]) {\n          case 58:\n            if (fieldLength === -1) {\n              fieldLength = position - lineStart;\n            }\n            break;\n          case 13:\n            discardTrailingNewline = true;\n          case 10:\n            lineEnd = position;\n            break;\n        }\n      }\n      if (lineEnd === -1) {\n        break;\n      }\n      onLine(buffer.subarray(lineStart, lineEnd), fieldLength);\n      lineStart = position;\n      fieldLength = -1;\n    }\n    if (lineStart === bufLength) {\n      buffer = void 0;\n    } else if (lineStart !== 0) {\n      buffer = buffer.subarray(lineStart);\n      position -= lineStart;\n    }\n  };\n}\nfunction getMessages(onId, onRetry, onMessage) {\n  let message = newMessage();\n  const decoder = new TextDecoder();\n  return function onLine(line, fieldLength) {\n    if (line.length === 0) {\n      onMessage === null || onMessage === void 0 ? void 0 : onMessage(message);\n      message = newMessage();\n    } else if (fieldLength > 0) {\n      const field = decoder.decode(line.subarray(0, fieldLength));\n      const valueOffset = fieldLength + (line[fieldLength + 1] === 32 ? 2 : 1);\n      const value = decoder.decode(line.subarray(valueOffset));\n      switch (field) {\n        case \"data\":\n          message.data = message.data ? message.data + \"\\n\" + value : value;\n          break;\n        case \"event\":\n          message.event = value;\n          break;\n        case \"id\":\n          onId(message.id = value);\n          break;\n        case \"retry\":\n          const retry = parseInt(value, 10);\n          if (!isNaN(retry)) {\n            onRetry(message.retry = retry);\n          }\n          break;\n      }\n    }\n  };\n}\nfunction concat(a, b) {\n  const res = new Uint8Array(a.length + b.length);\n  res.set(a);\n  res.set(b, a.length);\n  return res;\n}\nfunction newMessage() {\n  return {\n    data: \"\",\n    event: \"\",\n    id: \"\",\n    retry: void 0\n  };\n}\nvar __rest = function(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n    t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n    for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n      if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n        t[p[i]] = s[p[i]];\n    }\n  return t;\n};\nconst EventStreamContentType = \"text/event-stream\";\nconst DefaultRetryInterval = 1e3;\nconst LastEventId = \"last-event-id\";\nfunction fetchEventSource(input, _a22) {\n  var { signal: inputSignal, headers: inputHeaders, onopen: inputOnOpen, onmessage, onclose, onerror, openWhenHidden, fetch: inputFetch } = _a22, rest = __rest(_a22, [\"signal\", \"headers\", \"onopen\", \"onmessage\", \"onclose\", \"onerror\", \"openWhenHidden\", \"fetch\"]);\n  return new Promise((resolve, reject) => {\n    const headers = Object.assign({}, inputHeaders);\n    if (!headers.accept) {\n      headers.accept = EventStreamContentType;\n    }\n    let curRequestController;\n    function onVisibilityChange() {\n      curRequestController.abort();\n      if (!document.hidden) {\n        create();\n      }\n    }\n    if (!openWhenHidden) {\n      document.addEventListener(\"visibilitychange\", onVisibilityChange);\n    }\n    let retryInterval = DefaultRetryInterval;\n    let retryTimer = 0;\n    function dispose() {\n      document.removeEventListener(\"visibilitychange\", onVisibilityChange);\n      window.clearTimeout(retryTimer);\n      curRequestController.abort();\n    }\n    inputSignal === null || inputSignal === void 0 ? void 0 : inputSignal.addEventListener(\"abort\", () => {\n      dispose();\n      resolve();\n    });\n    const fetch2 = inputFetch !== null && inputFetch !== void 0 ? inputFetch : window.fetch;\n    const onopen = inputOnOpen !== null && inputOnOpen !== void 0 ? inputOnOpen : defaultOnOpen;\n    async function create() {\n      var _a3;\n      curRequestController = new AbortController();\n      try {\n        const response = await fetch2(input, Object.assign(Object.assign({}, rest), { headers, signal: curRequestController.signal }));\n        await onopen(response);\n        await getBytes(response.body, getLines(getMessages((id) => {\n          if (id) {\n            headers[LastEventId] = id;\n          } else {\n            delete headers[LastEventId];\n          }\n        }, (retry) => {\n          retryInterval = retry;\n        }, onmessage)));\n        onclose === null || onclose === void 0 ? void 0 : onclose();\n        dispose();\n        resolve();\n      } catch (err) {\n        if (!curRequestController.signal.aborted) {\n          try {\n            const interval = (_a3 = onerror === null || onerror === void 0 ? void 0 : onerror(err)) !== null && _a3 !== void 0 ? _a3 : retryInterval;\n            window.clearTimeout(retryTimer);\n            retryTimer = window.setTimeout(create, interval);\n          } catch (innerErr) {\n            dispose();\n            reject(innerErr);\n          }\n        }\n      }\n    }\n    create();\n  });\n}\nfunction defaultOnOpen(response) {\n  const contentType = response.headers.get(\"content-type\");\n  if (!(contentType === null || contentType === void 0 ? void 0 : contentType.startsWith(EventStreamContentType))) {\n    throw new Error(`Expected content-type to be ${EventStreamContentType}, Actual: ${contentType}`);\n  }\n}\nconst FRAME_SAFE_ERROR_KEY = \"__chatkit_error__\";\nclass HttpError extends Error {\n  constructor(message, res, metadata) {\n    super(message);\n    __publicField(this, \"status\");\n    __publicField(this, \"statusText\");\n    __publicField(this, \"metadata\");\n    this.name = \"HttpError\";\n    this.statusText = res.statusText;\n    this.status = res.status;\n    this.metadata = metadata;\n  }\n  static fromPossibleFrameSafeError(error) {\n    if (error instanceof HttpError) {\n      return error;\n    }\n    if (error && typeof error === \"object\" && FRAME_SAFE_ERROR_KEY in error && error[FRAME_SAFE_ERROR_KEY] === \"HttpError\") {\n      const safeError = error;\n      const parsedError = new HttpError(\n        safeError.message,\n        {\n          status: safeError.status,\n          statusText: safeError.statusText\n        },\n        safeError.metadata\n      );\n      parsedError.stack = safeError.stack;\n      return parsedError;\n    }\n    return null;\n  }\n}\n_a = FRAME_SAFE_ERROR_KEY;\nconst _FrameSafeHttpError = class _FrameSafeHttpError2 {\n  constructor(message, res, metadata) {\n    __publicField(this, _a, \"HttpError\");\n    __publicField(this, \"message\");\n    __publicField(this, \"stack\");\n    __publicField(this, \"status\");\n    __publicField(this, \"statusText\");\n    __publicField(this, \"metadata\");\n    this.message = message;\n    this.stack = new Error(message).stack;\n    this.status = res.status;\n    this.statusText = res.statusText;\n    this.metadata = metadata;\n  }\n  static fromHttpError(error) {\n    return new _FrameSafeHttpError2(\n      error.message,\n      {\n        status: error.status,\n        statusText: error.statusText\n      },\n      error.metadata\n    );\n  }\n};\nlet FrameSafeHttpError = _FrameSafeHttpError;\nconst BASE_RETRY_DELAY_MS = 1e3;\nconst MAX_RETRY_DELAY_MS = 1e4;\nconst MAX_RETRY_ATTEMPTS = 5;\nconst nextDelay = (attempt, maxRetryDelay = MAX_RETRY_DELAY_MS, baseDelayMs = BASE_RETRY_DELAY_MS) => {\n  const max = Math.min(maxRetryDelay, baseDelayMs * 2 ** attempt);\n  return Math.floor(max * (0.5 + Math.random() * 0.5));\n};\nclass RetryableError extends Error {\n  constructor(cause) {\n    super();\n    this.cause = cause;\n  }\n}\nconst fetchEventSourceWithRetry = async (url, params) => {\n  let retryAttempt = 0;\n  const { onopen, ...restParams } = params;\n  await fetchEventSource(url, {\n    ...restParams,\n    onopen: async (res) => {\n      var _a22;\n      onopen == null ? void 0 : onopen(res);\n      if (res.ok && ((_a22 = res.headers.get(\"content-type\")) == null ? void 0 : _a22.startsWith(\"text/event-stream\"))) {\n        retryAttempt = 0;\n        return;\n      }\n      const httpError = new FrameSafeHttpError(`Streaming failed: ${res.statusText}`, res);\n      if (res.status >= 400 && res.status < 500) {\n        throw httpError;\n      } else {\n        throw new RetryableError(httpError);\n      }\n    },\n    onerror: (error) => {\n      if (error instanceof RetryableError) {\n        if (retryAttempt >= MAX_RETRY_ATTEMPTS) {\n          throw error.cause;\n        }\n        retryAttempt += 1;\n        return nextDelay(retryAttempt);\n      }\n      throw error;\n    }\n  });\n};\nlet IntegrationError$1 = class IntegrationError extends Error {\n  constructor(message) {\n    super(message);\n    __publicField(this, \"_name\");\n    this.name = \"IntegrationError\";\n    this._name = this.name;\n  }\n  static fromPossibleFrameSafeError(error) {\n    if (error && typeof error === \"object\" && FRAME_SAFE_ERROR_KEY in error && error[FRAME_SAFE_ERROR_KEY] === \"IntegrationError\") {\n      const safeError = error;\n      const parsedError = new IntegrationError(safeError.message);\n      parsedError.stack = safeError.stack;\n      return parsedError;\n    }\n    return null;\n  }\n};\n_b = FRAME_SAFE_ERROR_KEY;\nclass FrameSafeIntegrationError {\n  constructor(message) {\n    __publicField(this, _b, \"IntegrationError\");\n    __publicField(this, \"message\");\n    __publicField(this, \"stack\");\n    this.message = message;\n    this.stack = new Error(message).stack;\n  }\n}\nclass BaseMessenger {\n  constructor({\n    handlers,\n    target,\n    targetOrigin,\n    fetch: fetch2 = window.fetch\n  }) {\n    __publicField(this, \"targetOrigin\");\n    __publicField(this, \"target\");\n    __publicField(this, \"commandHandlers\");\n    __publicField(this, \"_fetch\");\n    __publicField(this, \"emitter\", new EventEmitter());\n    __publicField(this, \"handlers\", /* @__PURE__ */ new Map());\n    __publicField(this, \"fetchEventSourceHandlers\", /* @__PURE__ */ new Map());\n    __publicField(this, \"abortControllers\", /* @__PURE__ */ new Map());\n    __publicField(this, \"commands\", new Proxy(\n      {},\n      {\n        get: (_, command) => {\n          return (data, transfer) => {\n            return new Promise((resolve, reject) => {\n              const nonce = crypto.randomUUID();\n              this.handlers.set(nonce, { resolve, reject, stack: new Error().stack || \"\" });\n              this.sendMessage(\n                {\n                  type: \"command\",\n                  nonce,\n                  command: `on${command.charAt(0).toUpperCase()}${command.slice(1)}`,\n                  data\n                },\n                transfer\n              );\n            });\n          };\n        }\n      }\n    ));\n    __publicField(this, \"handleMessage\", async (event) => {\n      var _a22, _b2, _c, _d;\n      if (!event.data || event.data.__xpaiChatKit !== true || event.origin !== this.targetOrigin || event.source !== this.target()) {\n        return;\n      }\n      const data = event.data;\n      switch (data.type) {\n        case \"event\": {\n          this.emitter.emit(data.event, data.data);\n          break;\n        }\n        case \"fetch\": {\n          try {\n            if (data.formData) {\n              const formData = new FormData();\n              for (const [key, value] of Object.entries(data.formData)) {\n                formData.append(key, value);\n              }\n              data.params.body = formData;\n            }\n            const controller = new AbortController();\n            this.abortControllers.set(data.nonce, controller);\n            data.params.signal = controller.signal;\n            const res = await this._fetch(data.url, data.params);\n            if (!res.ok) {\n              const message = await res.json().then((json2) => json2.message || res.statusText).catch(() => res.statusText);\n              throw new FrameSafeHttpError(message, res);\n            }\n            const json = await res.json().catch(() => ({}));\n            this.sendMessage({\n              type: \"response\",\n              response: json,\n              nonce: data.nonce\n            });\n          } catch (error) {\n            this.sendMessage({\n              type: \"response\",\n              error,\n              nonce: data.nonce\n            });\n          }\n          break;\n        }\n        case \"fetchEventSource\": {\n          try {\n            const controller = new AbortController();\n            this.abortControllers.set(data.nonce, controller);\n            await fetchEventSourceWithRetry(data.url, {\n              ...data.params,\n              signal: controller.signal,\n              fetch: this._fetch,\n              onmessage: (message) => {\n                this.sendMessage({\n                  type: \"fetchEventSourceMessage\",\n                  message,\n                  nonce: data.nonce\n                });\n              }\n            });\n            this.sendMessage({\n              type: \"response\",\n              response: void 0,\n              nonce: data.nonce\n            });\n          } catch (error) {\n            this.sendMessage({\n              type: \"response\",\n              error,\n              nonce: data.nonce\n            });\n          }\n          break;\n        }\n        case \"command\": {\n          console.log(\"Received command\", data.command, data.data);\n          if (!this.canReceiveCommand(data.command)) {\n            this.sendMessage({\n              type: \"response\",\n              error: new FrameSafeIntegrationError(`Command ${data.command} not supported`),\n              nonce: data.nonce\n            });\n            return;\n          }\n          try {\n            const response = await ((_b2 = (_a22 = this.commandHandlers)[data.command]) == null ? void 0 : _b2.call(_a22, data.data));\n            this.sendMessage({\n              type: \"response\",\n              response,\n              nonce: data.nonce\n            });\n          } catch (error) {\n            this.sendMessage({\n              type: \"response\",\n              error,\n              nonce: data.nonce\n            });\n          }\n          break;\n        }\n        case \"response\": {\n          const handler = this.handlers.get(data.nonce);\n          if (!handler) {\n            console.error(\"No handler found for nonce\", data.nonce);\n            return;\n          }\n          if (data.error) {\n            const integrationError = IntegrationError$1.fromPossibleFrameSafeError(data.error);\n            const httpError = HttpError.fromPossibleFrameSafeError(data.error);\n            if (integrationError) {\n              integrationError.stack = handler.stack;\n              handler.reject(integrationError);\n            } else if (httpError) {\n              handler.reject(httpError);\n            } else {\n              handler.reject(data.error);\n            }\n          } else {\n            handler.resolve(data.response);\n          }\n          this.handlers.delete(data.nonce);\n          break;\n        }\n        case \"fetchEventSourceMessage\": {\n          const handler = this.fetchEventSourceHandlers.get(data.nonce);\n          if (!handler) {\n            console.error(\"No handler found for nonce\", data.nonce);\n            return;\n          }\n          (_d = (_c = this.fetchEventSourceHandlers.get(data.nonce)) == null ? void 0 : _c.onmessage) == null ? void 0 : _d.call(_c, data.message);\n          break;\n        }\n        case \"abortSignal\": {\n          const controller = this.abortControllers.get(data.nonce);\n          if (controller) {\n            controller.abort(data.reason);\n            this.abortControllers.delete(data.nonce);\n          }\n          break;\n        }\n      }\n    });\n    this.commandHandlers = handlers;\n    this.target = target;\n    this.targetOrigin = targetOrigin;\n    this._fetch = (...args) => fetch2(...args);\n  }\n  setTargetOrigin(targetOrigin) {\n    this.targetOrigin = targetOrigin;\n  }\n  sendMessage(data, transfer) {\n    var _a22;\n    const message = {\n      __xpaiChatKit: true,\n      ...data\n    };\n    (_a22 = this.target()) == null ? void 0 : _a22.postMessage(message, this.targetOrigin, transfer);\n  }\n  connect() {\n    window.addEventListener(\"message\", this.handleMessage);\n  }\n  disconnect() {\n    window.removeEventListener(\"message\", this.handleMessage);\n  }\n  fetch(url, params) {\n    return new Promise((resolve, reject) => {\n      const nonce = crypto.randomUUID();\n      this.handlers.set(nonce, { resolve, reject, stack: new Error().stack || \"\" });\n      let formData;\n      if (params.body instanceof FormData) {\n        formData = {};\n        for (const [key, value] of params.body.entries()) {\n          formData[key] = value;\n        }\n        params.body = void 0;\n      }\n      if (params.signal) {\n        params.signal.addEventListener(\"abort\", () => {\n          var _a22;\n          this.sendMessage({\n            type: \"abortSignal\",\n            nonce,\n            reason: (_a22 = params.signal) == null ? void 0 : _a22.reason\n          });\n        });\n        params.signal = void 0;\n      }\n      this.sendMessage({ type: \"fetch\", nonce, params, formData, url });\n    });\n  }\n  // Supporting onopen would require a good way for us to serialize the Response object\n  // across the iframe boundary, which is not trivial and also not really necessary.\n  fetchEventSource(url, params) {\n    return new Promise((resolve, reject) => {\n      const { onmessage, signal, ...rest } = params;\n      const nonce = crypto.randomUUID();\n      this.handlers.set(nonce, { resolve, reject, stack: new Error().stack || \"\" });\n      this.fetchEventSourceHandlers.set(nonce, {\n        onmessage\n      });\n      if (signal) {\n        signal.addEventListener(\"abort\", () => {\n          this.sendMessage({\n            type: \"abortSignal\",\n            nonce,\n            reason: signal.reason\n          });\n        });\n      }\n      this.sendMessage({ type: \"fetchEventSource\", nonce, params: rest, url });\n    });\n  }\n  emit(...[event, data, transfer]) {\n    this.sendMessage(\n      {\n        type: \"event\",\n        event,\n        data\n      },\n      transfer\n    );\n  }\n  on(...[event, callback]) {\n    this.emitter.on(event, callback);\n  }\n  destroy() {\n    window.removeEventListener(\"message\", this.handleMessage);\n    this.emitter.allOff();\n    this.handlers.clear();\n  }\n}\nconst toUrlBase64 = (bin) => btoa(bin).replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=+$/, \"\");\nconst encodeBase64 = (value) => {\n  if (value === void 0) {\n    throw new TypeError(\n      \"encodeBase64: `undefined` cannot be encoded to valid JSON. Pass null instead.\"\n    );\n  }\n  const json = JSON.stringify(value);\n  const bytes = new TextEncoder().encode(json);\n  let bin = \"\";\n  for (const b of bytes) bin += String.fromCharCode(b);\n  return toUrlBase64(bin);\n};\nclass IntegrationError2 extends Error {\n}\nfunction fromPossibleFrameSafeError(err) {\n  return err.message;\n}\nconst BASE_CAPABILITY_ALLOWLIST = [\n  // commands\n  \"command.setOptions\",\n  \"command.sendUserMessage\",\n  \"command.setComposerValue\",\n  \"command.setThreadId\",\n  \"command.focusComposer\",\n  \"command.fetchUpdates\",\n  \"command.sendCustomAction\",\n  \"command.showHistory\",\n  \"command.hideHistory\",\n  // events\n  \"event.ready\",\n  \"event.error\",\n  \"event.log\",\n  \"event.response.start\",\n  \"event.response.end\",\n  \"event.response.stop\",\n  \"event.thread.change\",\n  \"event.tool.change\",\n  \"event.thread.load.start\",\n  \"event.thread.load.end\",\n  \"event.deeplink\",\n  \"event.effect\",\n  // errors\n  \"error.StreamError\",\n  \"error.StreamEventParsingError\",\n  \"error.WidgetItemError\",\n  \"error.InitialThreadLoadError\",\n  \"error.FileAttachmentError\",\n  \"error.HistoryViewError\",\n  \"error.FatalAppError\",\n  \"error.IntegrationError\",\n  \"error.EntitySearchError\",\n  \"error.DomainVerificationRequestError\",\n  // backend\n  \"backend.threads.get_by_id\",\n  \"backend.threads.list\",\n  \"backend.threads.update\",\n  \"backend.threads.delete\",\n  \"backend.threads.create\",\n  \"backend.threads.add_user_message\",\n  \"backend.threads.add_client_tool_output\",\n  \"backend.threads.retry_after_item\",\n  \"backend.threads.custom_action\",\n  \"backend.attachments.create\",\n  \"backend.attachments.get_preview\",\n  \"backend.attachments.delete\",\n  \"backend.items.list\",\n  \"backend.items.feedback\",\n  // thread item types\n  \"thread.item.generated_image\",\n  \"thread.item.user_message\",\n  \"thread.item.assistant_message\",\n  \"thread.item.client_tool_call\",\n  \"thread.item.widget\",\n  \"thread.item.task\",\n  \"thread.item.workflow\",\n  \"thread.item.end_of_turn\",\n  \"thread.item.image_generation\",\n  // widgets\n  \"widget.Basic\",\n  \"widget.Card\",\n  \"widget.ListView\",\n  \"widget.ListViewItem\",\n  \"widget.Badge\",\n  \"widget.Box\",\n  \"widget.Row\",\n  \"widget.Col\",\n  \"widget.Button\",\n  \"widget.Caption\",\n  \"widget.Chart\",\n  \"widget.Checkbox\",\n  \"widget.DatePicker\",\n  \"widget.Divider\",\n  \"widget.Form\",\n  \"widget.Icon\",\n  \"widget.Image\",\n  \"widget.Input\",\n  \"widget.Label\",\n  \"widget.Markdown\",\n  \"widget.RadioGroup\",\n  \"widget.Select\",\n  \"widget.Spacer\",\n  \"widget.Text\",\n  \"widget.Textarea\",\n  \"widget.Title\",\n  \"widget.Transition\"\n];\nconst BASE_CAPABILITY_DENYLIST = [\n  // --- commands\n  \"command.shareThread\",\n  \"command.setTrainingOptOut\",\n  // --- events\n  \"event.thread.restore\",\n  \"event.message.share\",\n  \"event.image.download\",\n  \"event.history.open\",\n  \"event.history.close\",\n  \"event.log.chatgpt\",\n  // --- errors\n  // These errors considered internal and are not exposed to the user by default.\n  \"error.HttpError\",\n  \"error.NetworkError\",\n  \"error.UnhandledError\",\n  \"error.UnhandledPromiseRejectionError\",\n  \"error.StreamEventHandlingError\",\n  \"error.StreamStopError\",\n  \"error.ThreadRenderingError\",\n  \"error.IntlError\",\n  \"error.AppError\",\n  // --- backend\n  \"backend.threads.stop\",\n  \"backend.threads.share\",\n  \"backend.threads.create_from_shared\",\n  \"backend.threads.init\",\n  \"backend.attachments.process\",\n  // widgets\n  \"widget.CardCarousel\",\n  \"widget.Favicon\",\n  \"widget.CardLinkItem\",\n  \"widget.Map\"\n];\nconst PROFILE_TO_RULES = {\n  \"chatkit\": {\n    allow: [...BASE_CAPABILITY_ALLOWLIST, \"thread.item.image_generation\"],\n    deny: BASE_CAPABILITY_DENYLIST\n  }\n};\nconst getCapabilities = (profile) => {\n  const rules = PROFILE_TO_RULES[profile];\n  const effective = new Set(rules.allow);\n  for (const capability of rules.deny ?? []) {\n    effective.delete(capability);\n  }\n  const commands = /* @__PURE__ */ new Set();\n  const events = /* @__PURE__ */ new Set();\n  const backend = /* @__PURE__ */ new Set();\n  const threadItems = /* @__PURE__ */ new Set();\n  const errors = /* @__PURE__ */ new Set();\n  const widgets = /* @__PURE__ */ new Set();\n  for (const capability of effective) {\n    if (capability.startsWith(\"command.\")) {\n      commands.add(capability.slice(\"command.\".length));\n      continue;\n    }\n    if (capability.startsWith(\"event.\")) {\n      events.add(capability.slice(\"event.\".length));\n      continue;\n    }\n    if (capability.startsWith(\"backend.\")) {\n      backend.add(capability.slice(\"backend.\".length));\n      continue;\n    }\n    if (capability.startsWith(\"thread.item.\")) {\n      threadItems.add(capability.slice(\"thread.item.\".length));\n    }\n    if (capability.startsWith(\"error.\")) {\n      errors.add(capability.slice(\"error.\".length));\n      continue;\n    }\n    if (capability.startsWith(\"widget.\")) {\n      widgets.add(capability.slice(\"widget.\".length));\n      continue;\n    }\n  }\n  return { commands, events, backend, threadItems, errors, widgets };\n};\nclass ChatFrameMessenger extends BaseMessenger {\n  // Messenger running in outer can always handle commands coming from inner\n  canReceiveCommand(_) {\n    return true;\n  }\n}\nconst removeMethods = (obj, seen = /* @__PURE__ */ new WeakSet()) => {\n  if (typeof obj === \"function\") return \"[ChatKitMethod]\";\n  if (typeof obj !== \"object\" || obj === null) return obj;\n  if (seen.has(obj)) return obj;\n  seen.add(obj);\n  if (Array.isArray(obj)) {\n    return obj.map((c) => removeMethods(c, seen));\n  }\n  const result = {};\n  for (const [key, value] of Object.entries(obj)) {\n    if (typeof value !== \"function\") {\n      result[key] = removeMethods(value, seen);\n    } else {\n      result[key] = \"[ChatKitMethod]\";\n    }\n  }\n  return result;\n};\nfunction getInnerOptions(options) {\n  return removeMethods(options);\n}\nfunction requireCommandCapability(value, context) {\n  const command = String(context.name);\n  return function(...args) {\n    if (!this.capabilities.commands.has(command)) {\n      throw new IntegrationError2(\n        `ChatKit command \"${String(command)}\" is not available for the \"${this.profile}\" profile.`\n      );\n    }\n    return value.apply(this, args);\n  };\n}\nclass ChatKitElementBase extends (_a2 = HTMLElement, _focusComposer_dec = [requireCommandCapability], _fetchUpdates_dec = [requireCommandCapability], _sendUserMessage_dec = [requireCommandCapability], _setComposerValue_dec = [requireCommandCapability], _setThreadId_dec = [requireCommandCapability], _shareThread_dec = [requireCommandCapability], _sendCustomAction_dec = [requireCommandCapability], _showHistory_dec = [requireCommandCapability], _hideHistory_dec = [requireCommandCapability], _setTrainingOptOut_dec = [requireCommandCapability], _a2) {\n  constructor({ profile }) {\n    super();\n    __runInitializers(_init, 5, this);\n    __privateAdd(this, _ChatKitElementBase_instances);\n    __privateAdd(this, _opts);\n    __privateAdd(this, _frameUrl);\n    __privateAdd(this, _frame);\n    __privateAdd(this, _wrapper);\n    __privateAdd(this, _shadow, this.attachShadow({ mode: \"open\" }));\n    __privateAdd(this, _resolveLoaded);\n    __privateAdd(this, _loaded, new Promise((resolve) => {\n      __privateSet(this, _resolveLoaded, resolve);\n    }));\n    __privateAdd(this, _messenger, new ChatFrameMessenger({\n      fetch: (...args) => {\n        var _a3;\n        const customFetch = ((_a3 = __privateGet(this, _opts)) == null ? void 0 : _a3.api) && \"fetch\" in __privateGet(this, _opts).api && __privateGet(this, _opts).api.fetch;\n        return customFetch ? customFetch(...args) : fetch(...args);\n      },\n      target: () => {\n        var _a3;\n        return ((_a3 = __privateGet(this, _frame)) == null ? void 0 : _a3.contentWindow) ?? null;\n      },\n      targetOrigin: window.location.origin,\n      handlers: {\n        onFileInputClick: ({ inputAttributes }) => {\n          return new Promise((resolve) => {\n            const input = document.createElement(\"input\");\n            for (const [key, value] of Object.entries(inputAttributes)) {\n              input.setAttribute(key, String(value));\n            }\n            const respond = () => {\n              resolve(Array.from(input.files || []));\n              if (__privateGet(this, _shadow).contains(input)) {\n                __privateGet(this, _shadow).removeChild(input);\n              }\n            };\n            input.addEventListener(\"cancel\", respond);\n            input.addEventListener(\"change\", respond);\n            __privateGet(this, _shadow).appendChild(input);\n            input.click();\n          });\n        },\n        onClientToolCall: async ({\n          name,\n          params,\n          id,\n          tool_call_id\n        }) => {\n          var _a3;\n          const onClientTool = (_a3 = __privateGet(this, _opts)) == null ? void 0 : _a3.onClientTool;\n          if (!onClientTool) {\n            __privateMethod(this, _ChatKitElementBase_instances, emitAndThrow_fn).call(this, new IntegrationError2(\n              `No handler for client tool calls. You'll need to add onClientTool to your ChatKit options.`\n            ));\n          }\n          return onClientTool({ name, params, id, tool_call_id });\n        },\n        onWidgetAction: async ({ action, widgetItem }) => {\n          var _a3, _b2;\n          const onAction = (_b2 = (_a3 = __privateGet(this, _opts)) == null ? void 0 : _a3.widgets) == null ? void 0 : _b2.onAction;\n          if (!onAction) {\n            __privateMethod(this, _ChatKitElementBase_instances, emitAndThrow_fn).call(this, new IntegrationError2(\n              `No handler for widget actions. You'll need to add widgets.onAction to your ChatKit options.`\n            ));\n          }\n          return onAction(action, widgetItem);\n        },\n        onEntitySearch: async ({ query }) => {\n          var _a3, _b2, _c;\n          return ((_c = (_b2 = (_a3 = __privateGet(this, _opts)) == null ? void 0 : _a3.entities) == null ? void 0 : _b2.onTagSearch) == null ? void 0 : _c.call(_b2, query)) ?? [];\n        },\n        onEntityClick: async ({ entity }) => {\n          var _a3, _b2, _c;\n          return (_c = (_b2 = (_a3 = __privateGet(this, _opts)) == null ? void 0 : _a3.entities) == null ? void 0 : _b2.onClick) == null ? void 0 : _c.call(_b2, entity);\n        },\n        onEntityPreview: async ({ entity }) => {\n          var _a3, _b2, _c;\n          return ((_c = (_b2 = (_a3 = __privateGet(this, _opts)) == null ? void 0 : _a3.entities) == null ? void 0 : _b2.onRequestPreview) == null ? void 0 : _c.call(_b2, entity)) ?? { preview: null };\n        },\n        onGetClientSecret: async (currentClientSecret) => {\n          if (!__privateGet(this, _opts) || !(\"getClientSecret\" in __privateGet(this, _opts).api) || !__privateGet(this, _opts).api.getClientSecret) {\n            __privateMethod(this, _ChatKitElementBase_instances, emitAndThrow_fn).call(this, new IntegrationError2(\n              \"Could not refresh the session because ChatKitOptions.api.getClientSecret is not configured.\"\n            ));\n          }\n          return __privateGet(this, _opts).api.getClientSecret(currentClientSecret ?? null);\n        },\n        onAddMetadataToRequest: ({\n          op,\n          params\n        }) => {\n          throw new IntegrationError2(\"ChatKit: onAddMetadataToRequest is unimplemented.\");\n        }\n      }\n    }));\n    __privateAdd(this, _handleFrameLoad, () => {\n      var _a3;\n      this.dataset.loaded = \"true\";\n      this.dispatchEvent(new CustomEvent(\"chatkit.ready\", { bubbles: true, composed: true }));\n      (_a3 = __privateGet(this, _resolveLoaded)) == null ? void 0 : _a3.call(this);\n    });\n    __privateAdd(this, _initialized, false);\n    this.profile = profile;\n    this.capabilities = getCapabilities(profile);\n  }\n  setProfile(profile) {\n    this.profile = profile;\n    this.capabilities = getCapabilities(profile);\n  }\n  connectedCallback() {\n    const style = document.createElement(\"style\");\n    style.textContent = `\n      :host {\n        display: block;\n        position: relative;\n        height: 100%;\n        width: 100%;\n      }\n      .ck-iframe {\n        border: none;\n        position: absolute;\n        inset: 0;\n        width: 100%;\n        height: 100%;\n        overflow: hidden;\n        color-scheme: light only;\n      }\n      .ck-wrapper {\n        position: absolute;\n        inset: 0;\n        width: 100%;\n        height: 100%;\n        overflow: hidden;\n        opacity: 0;\n      }\n      :host([data-color-scheme=\"dark\"]) .ck-iframe {\n        color-scheme: dark only;\n      }\n      :host([data-loaded=\"true\"]) .ck-wrapper {\n        opacity: 1;\n      }\n    `;\n    const frame = document.createElement(\"iframe\");\n    frame.className = \"ck-iframe\";\n    frame.name = \"chatkit\";\n    frame.role = \"presentation\";\n    frame.tabIndex = 0;\n    frame.setAttribute(\"allowtransparency\", \"true\");\n    frame.setAttribute(\"frameborder\", \"0\");\n    frame.setAttribute(\"scrolling\", \"no\");\n    frame.setAttribute(\"allow\", \"clipboard-read; clipboard-write\");\n    __privateSet(this, _frame, frame);\n    const wrapper = document.createElement(\"div\");\n    wrapper.className = \"ck-wrapper\";\n    wrapper.appendChild(frame);\n    __privateSet(this, _wrapper, wrapper);\n    __privateGet(this, _shadow).append(style);\n    __privateGet(this, _messenger).on(\"left_header_icon_click\", () => {\n      var _a3, _b2, _c;\n      (_c = (_b2 = (_a3 = __privateGet(this, _opts)) == null ? void 0 : _a3.header) == null ? void 0 : _b2.leftAction) == null ? void 0 : _c.onClick();\n    });\n    __privateGet(this, _messenger).on(\"right_header_icon_click\", () => {\n      var _a3, _b2, _c;\n      (_c = (_b2 = (_a3 = __privateGet(this, _opts)) == null ? void 0 : _a3.header) == null ? void 0 : _b2.rightAction) == null ? void 0 : _c.onClick();\n    });\n    __privateGet(this, _messenger).on(\"public_event\", ([event, data]) => {\n      if (!this.capabilities.events.has(event)) return;\n      if (event === \"error\" && \"error\" in data) {\n        const error = fromPossibleFrameSafeError(data.error);\n        this.dispatchEvent(new CustomEvent(\"chatkit.error\", { detail: { error } }));\n        if (error instanceof IntegrationError2) {\n          throw error;\n        }\n        return;\n      }\n      this.dispatchEvent(new CustomEvent(`chatkit.${event}`, { detail: data }));\n    });\n    __privateGet(this, _messenger).on(\"unmount\", () => {\n      if (__privateGet(this, _wrapper) && __privateGet(this, _shadow).contains(__privateGet(this, _wrapper))) {\n        __privateGet(this, _shadow).removeChild(__privateGet(this, _wrapper));\n        __privateSet(this, _wrapper, void 0);\n        __privateSet(this, _frame, void 0);\n      }\n    });\n    __privateGet(this, _messenger).on(\n      \"capabilities_profile_change\",\n      ({ profile }) => {\n        this.setProfile(profile);\n      }\n    );\n    frame.addEventListener(\"load\", __privateGet(this, _handleFrameLoad), { once: true });\n    try {\n      __privateMethod(this, _ChatKitElementBase_instances, maybeInit_fn).call(this);\n    } catch (error) {\n      console.error(error);\n      __privateMethod(this, _ChatKitElementBase_instances, emitAndThrow_fn).call(this, error instanceof Error ? error : new IntegrationError2(\"Failed to initialize ChatKit\"));\n    }\n  }\n  disconnectedCallback() {\n    var _a3;\n    (_a3 = __privateGet(this, _frame)) == null ? void 0 : _a3.removeEventListener(\"load\", __privateGet(this, _handleFrameLoad));\n    __privateGet(this, _messenger).disconnect();\n  }\n  applySanitizedOptions(newOptions) {\n    __privateSet(this, _opts, newOptions);\n    if (__privateGet(this, _initialized)) {\n      __privateMethod(this, _ChatKitElementBase_instances, setOptionsDataAttributes_fn).call(this, __privateGet(this, _opts));\n      __privateGet(this, _loaded).then(() => {\n        __privateGet(this, _messenger).commands.setOptions(getInnerOptions(newOptions));\n      });\n    } else {\n      __privateMethod(this, _ChatKitElementBase_instances, maybeInit_fn).call(this);\n    }\n  }\n  setOptions(newOptions) {\n    try {\n      const sanitized = this.sanitizeOptions(newOptions);\n      __privateMethod(this, _ChatKitElementBase_instances, consumeFrameUrl_fn).call(this, sanitized);\n      this.applySanitizedOptions(sanitized);\n    } catch (error) {\n      __privateMethod(this, _ChatKitElementBase_instances, emitAndThrow_fn).call(this, error instanceof Error ? error : new IntegrationError2(\"Failed to parse options\"));\n    }\n  }\n  async focusComposer() {\n    var _a3, _b2;\n    await __privateGet(this, _loaded);\n    (_a3 = __privateGet(this, _frame)) == null ? void 0 : _a3.focus();\n    await ((_b2 = __privateGet(this, _messenger)) == null ? void 0 : _b2.commands.focusComposer());\n  }\n  async fetchUpdates() {\n    var _a3;\n    await __privateGet(this, _loaded);\n    await ((_a3 = __privateGet(this, _messenger)) == null ? void 0 : _a3.commands.fetchUpdates());\n  }\n  async sendUserMessage(params) {\n    var _a3;\n    await __privateGet(this, _loaded);\n    await ((_a3 = __privateGet(this, _messenger)) == null ? void 0 : _a3.commands.sendUserMessage(params));\n  }\n  async setComposerValue(params) {\n    var _a3;\n    await __privateGet(this, _loaded);\n    await ((_a3 = __privateGet(this, _messenger)) == null ? void 0 : _a3.commands.setComposerValue(params));\n  }\n  async setThreadId(threadId) {\n    var _a3;\n    await __privateGet(this, _loaded);\n    await ((_a3 = __privateGet(this, _messenger)) == null ? void 0 : _a3.commands.setThreadId({ threadId }));\n  }\n  async shareThread() {\n    var _a3;\n    await __privateGet(this, _loaded);\n    return (_a3 = __privateGet(this, _messenger)) == null ? void 0 : _a3.commands.shareThread();\n  }\n  async sendCustomAction(action, itemId) {\n    var _a3;\n    await __privateGet(this, _loaded);\n    return (_a3 = __privateGet(this, _messenger)) == null ? void 0 : _a3.commands.sendCustomAction({ action, itemId });\n  }\n  async showHistory() {\n    var _a3;\n    await __privateGet(this, _loaded);\n    return (_a3 = __privateGet(this, _messenger)) == null ? void 0 : _a3.commands.showHistory();\n  }\n  async hideHistory() {\n    var _a3;\n    await __privateGet(this, _loaded);\n    return (_a3 = __privateGet(this, _messenger)) == null ? void 0 : _a3.commands.hideHistory();\n  }\n  async setTrainingOptOut(value) {\n    var _a3;\n    await __privateGet(this, _loaded);\n    return (_a3 = __privateGet(this, _messenger)) == null ? void 0 : _a3.commands.setTrainingOptOut({ value });\n  }\n}\n_init = __decoratorStart(_a2);\n_opts = new WeakMap();\n_frameUrl = new WeakMap();\n_frame = new WeakMap();\n_wrapper = new WeakMap();\n_shadow = new WeakMap();\n_resolveLoaded = new WeakMap();\n_loaded = new WeakMap();\n_messenger = new WeakMap();\n_ChatKitElementBase_instances = new WeakSet();\nemitAndThrow_fn = function(error) {\n  this.dispatchEvent(new CustomEvent(\"chatkit.error\", { detail: { error } }));\n  throw error;\n};\nsetOptionsDataAttributes_fn = function(options) {\n  var _a3;\n  this.dataset.colorScheme = typeof options.theme === \"string\" ? options.theme : ((_a3 = options.theme) == null ? void 0 : _a3.colorScheme) ?? \"light\";\n};\ngetFrameUrl_fn = function() {\n  if (!__privateGet(this, _frameUrl)) {\n    throw new IntegrationError2(\n      \"ChatKit frameUrl is not configured. Provide it via setOptions({ frameUrl }) before mounting.\"\n    );\n  }\n  return __privateGet(this, _frameUrl);\n};\nsetFrameUrl_fn = function(frameUrl) {\n  if (__privateGet(this, _initialized) && __privateGet(this, _frameUrl) && __privateGet(this, _frameUrl) !== frameUrl) {\n    throw new IntegrationError2(\n      \"ChatKit frameUrl cannot be changed after initialization. Create a new element to use a different URL.\"\n    );\n  }\n  __privateSet(this, _frameUrl, frameUrl);\n};\nconsumeFrameUrl_fn = function(options) {\n  if (!(\"frameUrl\" in options)) return;\n  const frameUrl = options.frameUrl;\n  delete options.frameUrl;\n  if (frameUrl == null) return;\n  if (typeof frameUrl !== \"string\" || frameUrl.trim() === \"\") {\n    throw new IntegrationError2(\"ChatKit frameUrl must be a non-empty string.\");\n  }\n  __privateMethod(this, _ChatKitElementBase_instances, setFrameUrl_fn).call(this, frameUrl);\n};\n_handleFrameLoad = new WeakMap();\n_initialized = new WeakMap();\nmaybeInit_fn = function() {\n  if (__privateGet(this, _initialized) || !__privateGet(this, _frame) || !__privateGet(this, _opts)) {\n    return;\n  }\n  __privateSet(this, _initialized, true);\n  __privateMethod(this, _ChatKitElementBase_instances, setOptionsDataAttributes_fn).call(this, __privateGet(this, _opts));\n  const frameURL = new URL(__privateMethod(this, _ChatKitElementBase_instances, getFrameUrl_fn).call(this), window.location.origin);\n  __privateGet(this, _messenger).setTargetOrigin(frameURL.origin);\n  frameURL.hash = encodeBase64({\n    options: getInnerOptions(__privateGet(this, _opts)),\n    referrer: window.location.origin,\n    profile: this.profile\n  });\n  __privateGet(this, _messenger).connect();\n  __privateGet(this, _frame).src = frameURL.toString();\n  if (__privateGet(this, _wrapper)) {\n    __privateGet(this, _shadow).append(__privateGet(this, _wrapper));\n  }\n};\n__decorateElement(_init, 1, \"focusComposer\", _focusComposer_dec, ChatKitElementBase);\n__decorateElement(_init, 1, \"fetchUpdates\", _fetchUpdates_dec, ChatKitElementBase);\n__decorateElement(_init, 1, \"sendUserMessage\", _sendUserMessage_dec, ChatKitElementBase);\n__decorateElement(_init, 1, \"setComposerValue\", _setComposerValue_dec, ChatKitElementBase);\n__decorateElement(_init, 1, \"setThreadId\", _setThreadId_dec, ChatKitElementBase);\n__decorateElement(_init, 1, \"shareThread\", _shareThread_dec, ChatKitElementBase);\n__decorateElement(_init, 1, \"sendCustomAction\", _sendCustomAction_dec, ChatKitElementBase);\n__decorateElement(_init, 1, \"showHistory\", _showHistory_dec, ChatKitElementBase);\n__decorateElement(_init, 1, \"hideHistory\", _hideHistory_dec, ChatKitElementBase);\n__decorateElement(_init, 1, \"setTrainingOptOut\", _setTrainingOptOut_dec, ChatKitElementBase);\n__decoratorMetadata(_init, ChatKitElementBase);\nclass ChatKitElement extends ChatKitElementBase {\n  constructor() {\n    super({ profile: \"chatkit\" });\n  }\n  sanitizeOptions(options) {\n    var _a3;\n    (_a3 = options.threadItemActions) == null ? true : delete _a3.share;\n    return options;\n  }\n}\nfunction registerChatKitElement(tag = \"xpertai-chatkit\") {\n  if (!(\"customElements\" in globalThis)) return;\n  if (!customElements.get(tag)) {\n    customElements.define(tag, ChatKitElement);\n  }\n}\nregisterChatKitElement();\n//# sourceMappingURL=xpert-chatkit.js.map\n","import type { ChatKitEvents, ChatKitOptions, XpertAIChatKit } from '@xpert-ai/chatkit-types';\nimport '@xpert-ai/chatkit-web-component';\n\ndeclare const sap: any;\n\ntype DotToCamelCase<S extends string> = S extends `${infer Head}.${infer Tail}`\n  ? `${Head}${Capitalize<DotToCamelCase<Tail>>}`\n  : S;\n\nexport type ToEventHandlerKey<K extends keyof ChatKitEvents> = K extends string\n  ? DotToCamelCase<K> extends `chatkit${infer EventName}`\n    ? `on${Capitalize<EventName>}`\n    : never\n  : never;\n\nexport type ChatKitEventHandlers = Partial<{\n  [K in keyof ChatKitEvents as ToEventHandlerKey<K>]: ChatKitEvents[K] extends CustomEvent<\n    infer Detail\n  >\n    ? Detail extends undefined\n      ? () => void\n      : (event: Detail) => void\n    : never;\n}>;\n\nexport type ChatKitUI5Config = ChatKitOptions & ChatKitEventHandlers;\n\ntype ListenerCleanup = (() => void) | undefined;\n// Some event-like properties are handled directly by the web component and should stay in options.\nconst EXCLUDED_HANDLER_KEYS = new Set(['onClientTool']);\n\nconst CHATKIT_METHOD_NAMES = Object.freeze([\n  'focusComposer',\n  'setThreadId',\n  'sendUserMessage',\n  'setComposerValue',\n  'fetchUpdates',\n  'sendCustomAction',\n] as const);\n\ntype ChatKitMethod = (typeof CHATKIT_METHOD_NAMES)[number];\ntype ChatKitMethodParams<K extends ChatKitMethod> = XpertAIChatKit[K] extends (\n  ...args: infer P\n) => any\n  ? P\n  : never;\n\nconst EVENT_HANDLER_MAP: {\n  [K in keyof ChatKitEvents]: ToEventHandlerKey<K>;\n} = {\n  'chatkit.error': 'onError',\n  'chatkit.response.end': 'onResponseEnd',\n  'chatkit.response.start': 'onResponseStart',\n  'chatkit.log': 'onLog',\n  'chatkit.thread.change': 'onThreadChange',\n  'chatkit.thread.load.start': 'onThreadLoadStart',\n  'chatkit.thread.load.end': 'onThreadLoadEnd',\n  'chatkit.ready': 'onReady',\n  'chatkit.effect': 'onEffect',\n};\n\nconst UI5_EVENT_NAME_MAP: Record<keyof ChatKitEvents, string> = {\n  'chatkit.error': 'error',\n  'chatkit.response.end': 'responseEnd',\n  'chatkit.response.start': 'responseStart',\n  'chatkit.log': 'log',\n  'chatkit.thread.change': 'threadChange',\n  'chatkit.thread.load.start': 'threadLoadStart',\n  'chatkit.thread.load.end': 'threadLoadEnd',\n  'chatkit.ready': 'ready',\n  'chatkit.effect': 'effect',\n};\n\nconst EVENT_NAMES = Object.keys(EVENT_HANDLER_MAP) as (keyof ChatKitEvents)[];\n\nfunction splitOptions(value: ChatKitUI5Config | undefined): {\n  options: ChatKitOptions;\n  handlers: ChatKitEventHandlers;\n} {\n  const options = {} as ChatKitOptions;\n  const handlers: ChatKitEventHandlers = {};\n\n  if (!value) {\n    return { options, handlers };\n  }\n\n  for (const [key, entry] of Object.entries(value)) {\n    if (/^on[A-Z]/.test(key) && !EXCLUDED_HANDLER_KEYS.has(key)) {\n      // Excluded handler keys (like onClientTool) stay in options because the web component manages them\n      const handlerKey = key as keyof ChatKitEventHandlers;\n      if (typeof entry === 'function') {\n        Object.assign(handlers, { [handlerKey]: entry });\n      }\n    } else {\n      (options as Record<string, unknown>)[key] = entry;\n    }\n  }\n\n  return { options, handlers };\n}\n\nfunction applyOptions(\n  el: XpertAIChatKit,\n  options: ChatKitOptions,\n  isCurrent: () => boolean,\n): ListenerCleanup {\n  if (typeof customElements === 'undefined') {\n    if (typeof el.setOptions === 'function') {\n      el.setOptions(options);\n    }\n    return undefined;\n  }\n\n  if (customElements.get('xpertai-chatkit')) {\n    el.setOptions(options);\n    return undefined;\n  }\n\n  let active = true;\n  customElements.whenDefined('xpertai-chatkit').then(() => {\n    if (active && isCurrent()) {\n      el.setOptions(options);\n    }\n  });\n\n  return () => {\n    active = false;\n  };\n}\n\nfunction getControlBase(): any {\n  if (sap?.ui?.core?.Control) {\n    return sap.ui.core.Control;\n  }\n\n  throw new Error('sap.ui.core.Control is required for @xpert-ai/chatkit-ui5');\n}\n\nconst ControlBase = getControlBase();\n\ntype InternalState = {\n  _chatkitEl: XpertAIChatKit | null;\n  _optionsCleanup?: ListenerCleanup;\n  _eventsAbortController: AbortController | null;\n  _options: ChatKitOptions;\n  _handlers: ChatKitEventHandlers;\n};\n\ntype ChatKitInstance = InstanceType<typeof ControlBase> & InternalState;\n\nexport const ChatKit = ControlBase.extend('xpertai.chatkit.ui5.ChatKit', {\n  metadata: {\n    properties: {\n      config: { type: 'object', defaultValue: {} },\n    },\n    events: {\n      error: { parameters: { detail: { type: 'object' } } },\n      responseEnd: { parameters: { detail: { type: 'object' } } },\n      responseStart: { parameters: { detail: { type: 'object' } } },\n      log: { parameters: { detail: { type: 'object' } } },\n      threadChange: { parameters: { detail: { type: 'object' } } },\n      threadLoadStart: { parameters: { detail: { type: 'object' } } },\n      threadLoadEnd: { parameters: { detail: { type: 'object' } } },\n      ready: { parameters: { detail: { type: 'object' } } },\n      effect: { parameters: { detail: { type: 'object' } } },\n    },\n  },\n  renderer: {\n    apiVersion: 2,\n    render(oRm: any, oControl: ChatKitInstance) {\n      oRm.openStart('xpertai-chatkit', oControl);\n      oRm.openEnd();\n      oRm.close('xpertai-chatkit');\n    },\n  },\n  init(this: ChatKitInstance) {\n    this._chatkitEl = null;\n    this._optionsCleanup = undefined;\n    this._eventsAbortController = null;\n\n    const config = typeof this.getProperty === 'function' ? this.getProperty('config') : {};\n    this._setConfig(config ?? {});\n  },\n  setConfig(this: ChatKitInstance, value: ChatKitUI5Config) {\n    if (typeof this.setProperty === 'function') {\n      this.setProperty('config', value ?? {}, true);\n    }\n    this._setConfig(value ?? {});\n    return this;\n  },\n  onAfterRendering(this: ChatKitInstance) {\n    this._chatkitEl = typeof this.getDomRef === 'function' ? this.getDomRef() : null;\n    this._applyOptions();\n    this._bindHandlers();\n  },\n  exit(this: ChatKitInstance) {\n    this._teardown();\n  },\n  _teardown(this: ChatKitInstance) {\n    if (this._optionsCleanup) {\n      this._optionsCleanup();\n      this._optionsCleanup = undefined;\n    }\n    if (this._eventsAbortController) {\n      this._eventsAbortController.abort();\n      this._eventsAbortController = null;\n    }\n    this._chatkitEl = null;\n  },\n  _setConfig(this: ChatKitInstance, value: ChatKitUI5Config) {\n    const next = splitOptions(value);\n    this._options = next.options;\n    this._handlers = next.handlers;\n    this._applyOptions();\n    this._bindHandlers();\n  },\n  _applyOptions(this: ChatKitInstance) {\n    if (this._optionsCleanup) {\n      this._optionsCleanup();\n      this._optionsCleanup = undefined;\n    }\n\n    const el = this._chatkitEl;\n    if (!el) return;\n\n    this._optionsCleanup = applyOptions(\n      el,\n      this._options,\n      () => typeof this.getDomRef === 'function' && this.getDomRef() === el,\n    );\n  },\n  _bindHandlers(this: ChatKitInstance) {\n    if (this._eventsAbortController) {\n      this._eventsAbortController.abort();\n      this._eventsAbortController = null;\n    }\n\n    const el = this._chatkitEl;\n    if (!el) return;\n\n    const controller = new AbortController();\n    for (const eventName of EVENT_NAMES) {\n      el.addEventListener(\n        eventName,\n        (e: Event) => {\n          const detail = (e as CustomEvent).detail;\n          const handlerName = EVENT_HANDLER_MAP[eventName];\n          const handler = this._handlers?.[handlerName];\n\n          if (typeof handler === 'function') {\n            handler(detail);\n          }\n\n          if (typeof this.fireEvent === 'function') {\n            this.fireEvent(UI5_EVENT_NAME_MAP[eventName], { detail });\n          }\n        },\n        { signal: controller.signal },\n      );\n    }\n\n    this._eventsAbortController = controller;\n  },\n  _callMethod(this: ChatKitInstance, method: ChatKitMethod, ...args: unknown[]) {\n    const el = this._chatkitEl;\n    const methodRef = el?.[method as keyof XpertAIChatKit];\n    if (!el || typeof methodRef !== 'function') {\n      if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n        console.warn('ChatKit element is not mounted');\n      }\n      return;\n    }\n\n    return (methodRef as (...args: unknown[]) => unknown).apply(el, args);\n  },\n  focusComposer(this: ChatKitInstance, ...args: ChatKitMethodParams<'focusComposer'>) {\n    return this._callMethod('focusComposer', ...args);\n  },\n  setThreadId(this: ChatKitInstance, ...args: ChatKitMethodParams<'setThreadId'>) {\n    return this._callMethod('setThreadId', ...args);\n  },\n  sendUserMessage(this: ChatKitInstance, ...args: ChatKitMethodParams<'sendUserMessage'>) {\n    return this._callMethod('sendUserMessage', ...args);\n  },\n  setComposerValue(this: ChatKitInstance, ...args: ChatKitMethodParams<'setComposerValue'>) {\n    return this._callMethod('setComposerValue', ...args);\n  },\n  fetchUpdates(this: ChatKitInstance, ...args: ChatKitMethodParams<'fetchUpdates'>) {\n    return this._callMethod('fetchUpdates', ...args);\n  },\n  sendCustomAction(this: ChatKitInstance, ...args: ChatKitMethodParams<'sendCustomAction'>) {\n    return this._callMethod('sendCustomAction', ...args);\n  },\n});\n"],"names":["self","_b","_a"],"mappings":"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"}